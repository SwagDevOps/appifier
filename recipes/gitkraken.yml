app: GitKraken

ingredients:
  dist: trusty
  sources:
    - deb http://archive.ubuntu.com/ubuntu/ trusty main universe
  script:
    - set -eux
    # variables ------------------------------------------------------
    - PACKAGE_URL=https://release.axocdn.com/linux/gitkraken-amd64.deb
    - FILE=`basename -- "${PACKAGE_URL}"`
    # cleanup --------------------------------------------------------
    - rm -rfv *.gz VERSION *.png *.svg *.deb *.sh tmp/
    # download -------------------------------------------------------
    - wget -c "${PACKAGE_URL}" -O "${FILE}"
    # version --------------------------------------------------------
    - dpkg -I "${FILE}" | awk '/^\s*Version:\s+/{print $2}' > VERSION

script:
  - set -eux
  # files ------------------------------------------------------------
  - ln -sfvr usr/share/gitkraken/gitkraken.png .
  - ln -sfvr usr/share/gitkraken/gitkraken usr/bin/
  # desktop ----------------------------------------------------------
  - cat > gitkraken.desktop << EOF
  - [Desktop Entry]
  - Type=Application
  - Name=GitKraken
  - Icon=gitkraken
  - Exec=/usr/bin/gitkraken %U
  - Categories=Development;IDE;
  - Comment=The downright luxurious Git client
  - EOF